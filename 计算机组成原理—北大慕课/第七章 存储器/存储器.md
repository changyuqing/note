# 存储器

## 存储器层次结构概况

### 存储器要考虑的特性

* **非易失性**    断电后数据不会丢失
* **可读可写**    既能够读出数据，也要求能够不断更新数据，即写入
* **随机访问**    访问存储器的某个位置的数据所花费的时间和数据所在的位置没有关系，可以访问任意位置的数据，典型的不可随机访问存储就是磁带
* **访问时间**    因为CPU速度很快，所以要求存储器也具有很快的速度，在一个时钟周期内能够提供给CPU需要运算的数据，否则CPU等待存储器提供数据会浪费时间，降低效率
* **容量**           存储器要能够装下程序运行需要的指令和数据
* **价格与功耗** 存储器性价比，还有功耗不能太高

### 现代计算机存储层次结构

针对实际使用时对存储器提出的要求，现在计算机将存储器分为了四个层次：

* **寄存器（Register）**  集成在CPU中，一般都是以字节为单位
* **高速缓存（Cache）**  集成在CPU中，容量KB~MB，也称为`SRAM`
* **主存（Main Memory）**  这里存放运行程序需要的内容，容量MB~GB，也称为`DRAM`
* **本地磁盘（Disk）**  存放各种数据，需要运行时会被调入主存，容量GM~TB

 ![mark](http://ogzrgstml.bkt.clouddn.com/blog/20170301/155524002.png)



### 存储器性能的影响

首先我们我们看一张图，CPU与各种存储器的性能对比

![mark](http://ogzrgstml.bkt.clouddn.com/blog/20170301/155530613.png)

图中我们看到2010年CPU的的时钟周期为`0.4ns`，`SRAM`的访问时间为`1.5ns`，`DRAM`的访问时间为`40ns`，`DISK`的访问时间为`3ms`(注意单位为毫秒)，也就是说明当CPU的某个时间周期，需要访问位于存储器的数据，如果这个数据在`SRAM`中，则需要等待`1.5/0.4`个时钟周期，如果数据在`DRAM`中，需要等待`40/0.4=10`个周期，数据在`DISK`中，则需要等待恐怖的`3/0.4`百万个时钟周期，自然而然，为了提高计算机运算效率，我们选择将`CPU`和`SRAM`直接连接。

这里我们以奔腾CPU执行指令的五个步骤为例子，如果我们将CPU直接和主存，也就是`DRAM`相连

 ![mark](http://ogzrgstml.bkt.clouddn.com/blog/20170301/155538529.png)

假设CPU内部要花一个周期产生访问存储器的地址，这个地址中存有指令的内容，那么CPU需要等待`100`个时钟周期等待`DRAM`中的数据返回，同样的如果执行指令的时候需要从`DRAM`中读取操作数，也要等待`100`个时钟周期

 ![mark](http://ogzrgstml.bkt.clouddn.com/blog/20170301/155547072.png)

但是，如果我们把CPU与`SRAM`相连，则会大大提高CPU的效率

 ![mark](http://ogzrgstml.bkt.clouddn.com/blog/20170301/155554898.png)

`SRAM`要比`DRAM`快很多，我们假设`CPU`从`SRAM`中取数据只要等待3个时钟周期

 ![mark](http://ogzrgstml.bkt.clouddn.com/blog/20170301/155603154.png)

正是因为各种存储器特性上的差别，为了满足需求，所以现在计算机将存储层次分为了寄存器，高速缓存Cache，主存和磁盘，当然，如果以后出现了一种速度又快，又便宜，支持随机访问，可读可写的存储器，那么这些乱七八糟的存储结构也就没有存在的必要了，直接一个存储器就能满足所有的要求。

## DRAM和SRAM

既不是地址总线宽度，也不是数据总线宽度，字长是ALU在一个时钟周期内最多能运算的二进制位数。



